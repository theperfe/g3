	<!DOCTYPE html>
	<meta charset="utf-8">
	<head>

	<style>

	.link {
	  stroke: #999;
	}

	</style>


	<!--<script type="text/javascript" src="d3.v2.js"></script>-->
	<script src="http://d3js.org/d3.v3.min.js"></script>

	</head>

	<body>
	<div id="viz"></div>
		<script type="text/javascript">

	//Checking if we can add edges just by clicking on source and target nodes. This code has a problem since I binded the event of clicking to the node even before the circles are created. Hence the problem. I corrected it, and put it in 22.html.

			var width = 900;
			var height = 500;
			var fill = d3.scale.category20();

			var nodes = [{},{}];	//just some two nodes to start with
			var links = [{"source":0, "target":1}];	//just an edge to start with

			var count = 0; //to know whether the mouse click was on the source node or on the target node while creating edges.
			var source, target; //source and target nodes while creating edges using mouse clicks.

			var force = d3.layout.force()
					.size([width,height])
					.nodes(nodes)
					.links(links)
					.linkDistance(30)
					.charge(-60)
					.on("tick", tick);

			var svg = d3.select("#viz")
				.append("svg")
				.attr("width",width)
				.attr("height", height)
				.style("border", "2px solid black")
				.on("mousedown", svg_mousedown);

	//		var nodes = force.nodes(),
	//		    links = force.links();

			   var node = svg.selectAll(".node").on("mousedown", node_mousedown);
	//		   console.log(node);
			   var link = svg.selectAll(".link");


			function svg_mousedown()
			{
				var point = d3.mouse(this),
					node = {x:point[0],y:point[1]};
					nodes.push(node);
	//				console.log("entered");
					restart();
			}

			function node_mousedown(d,i)
			{

					console.log("entered");
				if(count == 1)
				{
	//				console.log("entered");
					target = i;
					links.push({"source":source, "target":target});
					count = 0;
					restart();
				}
				else if (count == 0)
				{
	//				console.log("entered");
					source = i;
					count = 1;
				}

			}
				

			function tick() {
				link.attr("x1", function(d) { return d.source.x; })
				    .attr("y1", function(d) { return d.source.y; })
				    .attr("x2", function(d) { return d.target.x; })
				    .attr("y2", function(d) { return d.target.y; });

				node.attr("cx", function(d) { return d.x; })
				    .attr("cy", function(d) { return d.y; });
			}

			function restart()
			{

				link = link.data(links);

				link.enter().append("line")
				.attr("class", "link");

				node = node.data(nodes);

				node.enter().append("circle")
				.attr("class", "node")
				.attr("r", 7)
				.call(force.drag);

				force.start();
//				console.log(svg.selectAll(".node"));

			}

			restart();
	</script>

